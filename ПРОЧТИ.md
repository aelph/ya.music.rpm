# Yandex Music RPM Workaround for Fedora/openSUSE

Этот репозиторий содержит инструмент для адаптации официального `.deb` пакета Яндекс Музыки для использования в RPM-дистрибутивах (Fedora, openSUSE).

## Особенности сборки

- **Hi-Res Audio:** Подтверждена стабильная работа на частотах до **176,4 КГц** через ALSA.
- **Bluetooth:** Оптимизировано для работы с кодеком LDAC (проверено на Sony WH-XB900N, 88.2 КГц).
- **Название пакета** Alien автоматически инкрементирует версию пакета для корректной работы пакетного менеджера. Вы получите надпись Beta, там где в приложении указывается номер сборки.
- **Интеграция:** Исправлены категории меню (теперь отображается в разделе "Музыка") и исправлено отображение иконок в панели задач (StartupWMClass). Эти изменения только в ярлыке приложения. Сам исходный код не изменялся.

## Как использовать

1. Склонируйте репозиторий.
2. Установите зависимости: `sudo dnf install alien curl desktop-file-utils`.
3. Запустите скрипт обычным пользователем: `./build_rpm.sh`.

Скрипт выполняет большую часть действий от обычного пользователя и использует `sudo` только для привилегированных операций (установка RPM, копирование ярлыка и обновление базы десктоп-файлов). При необходимости он запросит пароль `sudo` один раз в начале и кеширует его на короткое время, чтобы не спрашивать пароль для каждой команды.

Если вы запустите скрипт полностью под `root` (`sudo ./build_rpm.sh`), дополнительных запросов пароля не будет, но это не рекомендуется: файлы и каталоги в директории запуска могут стать принадлежащими root. Скрипт пытается восстановить владельца созданных файлов при запуске через `sudo`, но безопаснее запускать его без `sudo`.

## Почему не готовый RPM?

Чтобы не нарушать лицензионные права правообладателя, в этом репозитории бинарный файл приведён только в качестве примера успешной работы скрипта.

Скрипт только автоматизирует процесс конвертации официального пакета, предоставленного Яндексом, для вашей локальной системы. 

Никаких изменений в исходный код не вносится, производится только пересборка пакета с использованием инструмента alien.

## Обновление

Для обновления приложения запустите скрипт повторно обычным пользователем: `./build_rpm.sh`.
Если понадобятся привилегии, скрипт сам запросит `sudo` как описано выше.

## Решение проблем со звуком

Если у вас возникают прерывания на Bluetooth-наушниках, рекомендуется использовать кратную частоту дискретизации (например, 88.2 КГц для исходника 176.4 КГц).